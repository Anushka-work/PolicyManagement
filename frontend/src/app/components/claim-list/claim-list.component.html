<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>{{ authService.canApproveClaim() ? 'Claims - Approval Queue' : 'My Claims' }}</h2>
    <!-- Only USER can create new claims -->
    <button class="btn btn-primary" (click)="createClaim()" *ngIf="authService.canApplyClaim()">
      + Apply New Claim
    </button>
  </div>

  <div *ngIf="errorMessage" class="alert alert-danger">
    {{ errorMessage }}
  </div>

  <div *ngIf="loading" class="text-center">
    <p>Loading claims...</p>
  </div>

  <div *ngIf="!loading && claims.length === 0" class="alert alert-info">
    No claims found. Click "Add New Claim" to create one.
  </div>

  <div *ngIf="!loading && claims.length > 0" class="card">
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead>
            <tr>
              <th>Claim ID</th>
              <th>User ID</th>
              <th>Claim Amount</th>
              <th>Claim Type</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let claim of claims">
              <td>{{ claim.id }}</td>
              <td>{{ claim.userId }}</td>
              <td>â‚¹{{ claim.claimAmount }}</td>
              <td>{{ claim.claimType }}</td>
              <td>
                <span class="badge" [ngClass]="{
                  'bg-success': claim.status === 'APPROVED',
                  'bg-danger': claim.status === 'REJECTED',
                  'bg-warning': claim.status === 'PENDING'
                }">
                  {{ claim.status }}
                </span>
              </td>
              <td>
                <!-- USER can edit their own claims -->
                <button class="btn btn-sm btn-info me-2" (click)="editClaim(claim.id!)" *ngIf="authService.canApplyClaim()">
                  Edit
                </button>
                <!-- USER can delete their own claims -->
                <button class="btn btn-sm btn-danger me-2" (click)="deleteClaim(claim.id!)" *ngIf="authService.canApplyClaim()">
                  Delete
                </button>
                <!-- APPROVER can approve/reject claims -->
                <button class="btn btn-sm btn-success me-2" (click)="approveClaim(claim.id!)" *ngIf="authService.canApproveClaim() && claim.status === 'PENDING'">
                  Approve
                </button>
                <button class="btn btn-sm btn-danger" (click)="rejectClaim(claim.id!)" *ngIf="authService.canApproveClaim() && claim.status === 'PENDING'">
                  Reject
                </button>
                <!-- View details for approved claims -->
                <button class="btn btn-sm btn-secondary" *ngIf="claim.status !== 'PENDING'">
                  View Details
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>